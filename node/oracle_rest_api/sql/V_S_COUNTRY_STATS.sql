create or replace view REST_DATA.V_S_COUNTRY_STATS as
select countrycode,
       year,
       nvl(val,0) as val,
       nvl(val-lag(val) over (order by countrycode,year),0) as diff
from rest_data.s_country_stats
unpivot include nulls
   ( val for( year ) in
      (  y1960 as '1960',
         y1961 as '1961',
         y1962 as '1962',
         y1963 as '1963',
         y1964 as '1964',
         y1965 as '1965',
         y1966 as '1966',
         y1967 as '1967',
         y1968 as '1968',
         y1969 as '1969',
         y1970 as '1970',
         y1971 as '1971',
         y1972 as '1972',
         y1973 as '1973',
         y1974 as '1974',
         y1975 as '1975',
         y1976 as '1976',
         y1977 as '1977',
         y1978 as '1978',
         y1979 as '1979',
         y1980 as '1980',
         y1981 as '1981',
         y1982 as '1982',
         y1983 as '1983',
         y1984 as '1984',
         y1985 as '1985',
         y1986 as '1986',
         y1987 as '1987',
         y1988 as '1988',
         y1989 as '1989',
         y1990 as '1990',
         y1991 as '1991',
         y1992 as '1992',
         y1993 as '1993',
         y1994 as '1994',
         y1995 as '1995',
         y1996 as '1996',
         y1997 as '1997',
         y1998 as '1998',
         y1999 as '1999',
         y2000 as '2000',
         y2001 as '2001',
         y2002 as '2002',
         y2003 as '2003',
         y2004 as '2004',
         y2005 as '2005',
         y2006 as '2006',
         y2007 as '2007',
         y2008 as '2008',
         y2009 as '2009',
         y2010 as '2010',
         y2011 as '2011',
         y2012 as '2012',
         y2013 as '2013',
         y2014 as '2014',
         y2015 as '2015'
      )
    )
order by
countrycode,
         year;
